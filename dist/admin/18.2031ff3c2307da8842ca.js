(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{cR4Q:function(t,e,a){"use strict";a.r(e),a.d(e,"StudentsModule",(function(){return w}));var s=a("ofXK"),r=a("tyNb"),n=a("M9IT"),i=a("lJxs"),o=a("IzEk"),c=a("fXoL"),u=a("tk/3"),l=a("2Vo4"),d=a("HDdC"),b=a("JIr8"),p=a("AytR"),h=a("i5l0"),m=a("dNgK");let g=(()=>{class t{constructor(t,e){this.http=t,this.snackBar=e,this.resultSubject$=new l.a(null)}get resultItems$(){return this.resultSubject$}setItems(t){this.resultSubject$.next(t)}storeStudent(t){const e=Object(h.a)(t);return this.http.post(`${p.a.API}${p.a.routesCRUD.students}`,e).pipe(Object(i.a)(t=>(this.getStudents(1,20,"","desc").pipe(Object(o.a)(1)).subscribe(),this.openSnackBar("Se cre\xf3 correctamente","success-snack-bar"),t.data)),Object(b.a)(t=>this.errorHandler(t)))}updateStudent(t){const e=Object(h.a)(t);return e.append("_method","put"),this.http.post(`${p.a.API}${p.a.routesCRUD.students}/${t.user_id}`,e).pipe(Object(i.a)(t=>(this.getStudents(1,20,"","desc").pipe(Object(o.a)(1)).subscribe(),this.openSnackBar("Actualizado correctamente","success-snack-bar"),t.data)),Object(b.a)(t=>this.errorHandler(t)))}getStudents(t=1,e=20,a="",s="desc"){return this.http.get(`${p.a.API}${p.a.routesCRUD.students}`,{params:(new u.c).set("page",t.toString()).set("filter",a).set("sort",s).set("per_page",e.toString())}).pipe(Object(i.a)(t=>(console.log(t),this.setItems(t),t)),Object(b.a)(t=>this.errorHandler(t)))}deleteStudent(t){return this.http.delete(`${p.a.API}${p.a.routesCRUD.students}/${t}`).pipe(Object(i.a)(t=>(this.getStudents(1,20,"","desc").pipe(Object(o.a)(1)).subscribe(),this.openSnackBar("Eliminado correctamente","success-snack-bar"),t.data)),Object(b.a)(t=>this.errorHandler(t)))}openSnackBar(t,e,a=""){this.snackBar.open(t,a,{duration:1e3,horizontalPosition:"center",verticalPosition:"top",panelClass:e})}errorHandler(t){return this.openSnackBar(t.message||"error en la solicitud.","error-snack-bar"),d.a.throw(t.message||"error en la solicitud.")}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(u.a),c.Yb(m.a))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var S=a("0IaG"),f=a("DxCA"),v=a("Wp6s"),O=a("bTqV"),j=a("NFeN"),I=a("JhQZ"),C=a("lkLn");const U=function(){return[20,50,100]},k=[{path:"",component:(()=>{class t{constructor(t,e,a,s){this.studentsService=t,this.dialog=e,this.roleService=a,this.router=s,this.columns=[{title:"ID",col:"id"},{title:"Foto",col:"image"},{title:"Nombre",col:"name"},{title:"Email",col:"email"}],this.pageDefault=1,this.perPage=10,this.orden="desc",this.filter="",this.subscroptions=[],this.result=this.studentsService.resultItems$}ngOnInit(){this.getStudents(this.pageDefault,this.perPage,this.filter,this.orden),this.subscroptions.push(this.roleService.getRoles().subscribe(t=>{this.optionsRoles=t.map(t=>({name:t.name,value:t.id}))}))}paginatorChange(t){console.log(t),this.getStudents(t.pageIndex+1,t.pageSize)}getStudents(t,e,a,s){this.subscroptions.push(this.studentsService.getStudents(t,e,a,s).subscribe(t=>this.loadData()))}loadData(){this.dataSource=this.result.pipe(Object(i.a)(t=>t.data.data.map(t=>({id:t.id,name:`${t.name} ${t.last_name}`,email:t.email,image:t.account.image})))),this.totalResut=this.result.pipe(Object(i.a)(t=>t.data.total))}search(t){this.getStudents(this.pageDefault,this.perPage,t,this.orden)}deleteItem(t){return this.studentsService.deleteStudent(t)}itemAction(t){console.log(t),console.log(t),"delete"===t.action&&this.deleteItem(t.element.id).pipe(Object(o.a)(1)).subscribe(t=>console.log(t)),"edit"===t.action&&this.router.navigate(["/alumnos/editar-usuario",t.element.id])}ngOnDestroy(){this.subscroptions.map(t=>t.unsubscribe())}add(){}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(g),c.Ob(S.b),c.Ob(f.a),c.Ob(r.b))},t.\u0275cmp=c.Ib({type:t,selectors:[["mvd-students"]],viewQuery:function(t,e){var a;1&t&&c.yc(n.a,!0),2&t&&c.pc(a=c.cc())&&(e.paginator=a.first)},decls:22,vars:11,consts:[[1,"card","mat-elevation-z16","animate__animated","animate__slideInRight"],[1,"actions"],["mat-flat-button","","routerLink","/alumnos/editar-usuario","color","primary"],[1,"material-icons-round"],["mat-flat-button","","color","",1,"btn-simple"],[3,"noteFilterBy","changeSearch"],[3,"columns","dataSource","actionChange"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[1,"border"]],template:function(t,e){1&t&&(c.Ub(0,"mat-card",0),c.Ub(1,"mat-card-header"),c.Ub(2,"mat-card-title"),c.Ec(3,"Alumnos"),c.Tb(),c.Ub(4,"mat-card-subtitle"),c.Ec(5,"Administrar Alumno"),c.Tb(),c.Ub(6,"div",1),c.Ub(7,"button",2),c.Ub(8,"mat-icon",3),c.Ec(9,"add"),c.Tb(),c.Ec(10," Crear "),c.Tb(),c.Ub(11,"button",4),c.Ub(12,"mat-icon",3),c.Ec(13,"save_alt"),c.Tb(),c.Ec(14," Exportar "),c.Tb(),c.Tb(),c.Ub(15,"mvd-input-search",5),c.bc("changeSearch",(function(t){return e.search(t)})),c.Tb(),c.Tb(),c.Ub(16,"mat-card-content"),c.Ub(17,"mvd-data-table",6),c.bc("actionChange",(function(t){return e.itemAction(t)})),c.gc(18,"async"),c.Tb(),c.Ub(19,"mat-paginator",7),c.bc("page",(function(t){return e.paginatorChange(t)})),c.gc(20,"async"),c.Tb(),c.Tb(),c.Pb(21,"span",8),c.Tb()),2&t&&(c.Cb(15),c.lc("noteFilterBy","Filtra por Nombre o Email"),c.Cb(2),c.lc("columns",e.columns)("dataSource",c.hc(18,6,e.dataSource)),c.Cb(2),c.lc("length",c.hc(20,8,e.totalResut))("pageSize",e.perPage)("pageSizeOptions",c.mc(10,U)))},directives:[v.a,v.f,v.m,v.l,O.b,r.c,j.a,I.a,v.d,C.a,n.a],pipes:[s.b],styles:[""]}),t})()},{path:"editar-usuario/:id",loadChildren:()=>a.e(0).then(a.bind(null,"uRVJ")).then(t=>t.EditUserModule)},{path:"editar-usuario",loadChildren:()=>a.e(0).then(a.bind(null,"uRVJ")).then(t=>t.EditUserModule)}];let y=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},imports:[[r.f.forChild(k)],r.f]}),t})();var $=a("PCNd");let w=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},imports:[[s.c,y,$.a]]}),t})()}}]);